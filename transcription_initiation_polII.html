<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Инициация транскрипции Pol II — схема процесса</title>
  <!-- Spec-Version: v1.1 | Generated-At: 2025-09-29 | LANG: HTML | TOPIC: Transcription initiation (Pol II, +1 TSS) | ORG: eukaryote | LEVEL: advanced | VIEW: process | THEME: print | EXPORTS: svg,png,pdf | LAYOUT: A4-landscape | INTERACTIVE: on -->
  <style>
    :root {
      color-scheme: only light;
      font-family: "Fira Sans", "Segoe UI", system-ui, sans-serif;
      --bg: #ffffff;
      --ink: #111111;
      --accent: #1d4ed8;
      --accent-soft: rgba(29, 78, 216, 0.12);
      --accent-strong: rgba(29, 78, 216, 0.75);
      --muted: #555555;
      --grid-line: rgba(0, 0, 0, 0.08);
      --highlight: #d97706;
    }
    * {
      box-sizing: border-box;
    }
    html, body {
      margin: 0;
      padding: 0;
      background: var(--bg);
      color: var(--ink);
      height: 100%;
    }
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 12mm;
    }
    .page {
      width: 297mm;
      height: 210mm;
      background: var(--bg);
      border: 1px solid rgba(0,0,0,0.08);
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.12);
      display: grid;
      grid-template-rows: auto 1fr auto;
      gap: 8mm;
      padding: 14mm 18mm;
      position: relative;
      overflow: hidden;
    }
    .page::before {
      content: "";
      position: absolute;
      inset: 0;
      background-image: linear-gradient(to right, transparent 0, transparent 28mm, var(--grid-line) 28mm, transparent 28.5mm),
        linear-gradient(to bottom, transparent 0, transparent 28mm, var(--grid-line) 28mm, transparent 28.5mm);
      opacity: 0.45;
      pointer-events: none;
    }
    header {
      display: grid;
      grid-template-columns: 1fr auto;
      align-items: start;
      gap: 12mm;
    }
    header h1 {
      margin: 0;
      font-size: 22pt;
      letter-spacing: -0.4pt;
    }
    header .meta {
      text-align: right;
      font-size: 9pt;
      line-height: 1.4;
      color: var(--muted);
    }
    main {
      display: grid;
      grid-template-columns: 1.1fr 1fr;
      gap: 10mm;
    }
    .block {
      background: rgba(255,255,255,0.94);
      border: 1px solid rgba(0,0,0,0.1);
      border-radius: 6px;
      padding: 6mm;
      position: relative;
      overflow: hidden;
    }
    .block h2 {
      margin-top: 0;
      font-size: 14pt;
      letter-spacing: -0.2pt;
    }
    .block p, .block li {
      font-size: 10pt;
      line-height: 1.45;
    }
    .block ul {
      margin: 0;
      padding-left: 4mm;
      list-style: square;
    }
    .pill {
      display: inline-flex;
      align-items: center;
      gap: 2mm;
      background: var(--accent-soft);
      color: var(--accent);
      border-radius: 999px;
      padding: 1mm 4mm;
      font-size: 8pt;
      text-transform: uppercase;
      letter-spacing: 0.6pt;
    }
    .flow-map {
      position: relative;
      height: 100%;
    }
    .flow-map svg {
      width: 100%;
      height: 100%;
    }
    .flow-map .step-label {
      font-size: 9pt;
      fill: var(--ink);
      font-weight: 600;
    }
    .flow-map .step-note {
      font-size: 8pt;
      fill: var(--muted);
    }
    .legend {
      display: flex;
      flex-wrap: wrap;
      gap: 4mm;
      margin-top: 4mm;
    }
    .legend-item {
      display: flex;
      align-items: center;
      gap: 2mm;
      font-size: 8.5pt;
      color: var(--muted);
    }
    .legend-swatch {
      width: 8mm;
      height: 3mm;
      border-radius: 2mm;
      background: var(--accent-strong);
    }
    .legend-item[data-type="chromatin"] .legend-swatch {
      background: #4d7c0f;
    }
    .legend-item[data-type="rna"] .legend-swatch {
      background: #b91c1c;
    }
    .timeline {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 3mm;
      margin-top: 4mm;
    }
    .timeline button {
      border: 1px solid rgba(0,0,0,0.18);
      border-radius: 4px;
      padding: 4mm 3mm;
      background: #f8fafc;
      font-size: 9pt;
      cursor: pointer;
      text-align: left;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .timeline button.active {
      border-color: var(--accent);
      box-shadow: 0 4px 10px rgba(29,78,216,0.18);
      transform: translateY(-1mm);
    }
    .timeline button span {
      display: block;
    }
    .timeline button .title {
      font-weight: 600;
      color: var(--ink);
      margin-bottom: 1mm;
    }
    .timeline button .detail {
      color: var(--muted);
      line-height: 1.4;
    }
    .step-panel {
      margin-top: 5mm;
      background: #f1f5f9;
      border: 1px solid rgba(0,0,0,0.1);
      border-radius: 5px;
      padding: 5mm;
      min-height: 42mm;
    }
    .step-panel h3 {
      margin: 0 0 2mm;
      font-size: 12pt;
    }
    .step-panel ul {
      margin: 0;
      padding-left: 4mm;
    }
    .regulation-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 4mm;
      margin-top: 4mm;
    }
    .chip {
      background: rgba(0,0,0,0.04);
      border: 1px dashed rgba(0,0,0,0.2);
      border-radius: 5px;
      padding: 3mm;
      font-size: 8.5pt;
      line-height: 1.4;
    }
    footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 8pt;
      color: var(--muted);
    }
    footer .controls {
      display: flex;
      gap: 4mm;
    }
    footer button {
      padding: 2.5mm 4.5mm;
      font-size: 8pt;
      border-radius: 4px;
      border: 1px solid rgba(0,0,0,0.2);
      background: #ffffff;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
    }
    footer button:hover {
      background: var(--accent);
      color: #ffffff;
    }
    .overlay {
      position: absolute;
      inset: 0;
      background: rgba(255,255,255,0.98);
      display: none;
      flex-direction: column;
      padding: 18mm;
      gap: 6mm;
    }
    .overlay.active {
      display: flex;
    }
    .overlay h2 {
      margin: 0;
      font-size: 16pt;
    }
    .overlay table {
      border-collapse: collapse;
      width: 100%;
      font-size: 9.5pt;
    }
    .overlay th, .overlay td {
      border: 1px solid rgba(0,0,0,0.2);
      padding: 2.5mm;
      text-align: left;
    }
    .close-overlay {
      align-self: flex-end;
      border: none;
      background: var(--accent);
      color: #fff;
      padding: 2mm 5mm;
      border-radius: 4px;
      font-size: 9pt;
      cursor: pointer;
    }
    @media print {
      body {
        padding: 0;
        box-shadow: none;
      }
      .page {
        margin: 0;
        box-shadow: none;
        border: none;
      }
      footer button {
        display: none;
      }
    }
  </style>
</head>
<body>
  <div class="page" role="document" aria-label="A4 схема инициации транскрипции Pol II">
    <header>
      <div>
        <h1>Инициация транскрипции Pol II на +1 TSS</h1>
        <div class="pill">Eukaryote · Advanced · Process View</div>
      </div>
      <div class="meta">
        <div>Окружение: ядро эукариот</div>
        <div>Контекст: промотор класса II, TATA+/Inr</div>
        <div>Фокус: формирование и запуск PIC</div>
      </div>
    </header>
    <main>
      <section class="block flow-map" aria-labelledby="map-title">
        <h2 id="map-title">Схема сборки и переходов</h2>
        <svg viewBox="0 0 760 420" role="img" aria-describedby="map-desc">
          <desc id="map-desc">Графическое представление сборки преинициаторного комплекса Pol II и продвижения к промоторному побегу.</desc>
          <defs>
            <linearGradient id="gradPolII" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" stop-color="#bfdbfe" />
              <stop offset="100%" stop-color="#60a5fa" />
            </linearGradient>
            <linearGradient id="gradMediator" x1="0%" y1="0%" x2="0%" y2="100%">
              <stop offset="0%" stop-color="#ede9fe" />
              <stop offset="100%" stop-color="#c4b5fd" />
            </linearGradient>
          </defs>
          <rect x="30" y="40" width="700" height="320" fill="#f8fafc" stroke="rgba(0,0,0,0.15)" stroke-dasharray="6 4" rx="12" ry="12"></rect>
          <text class="step-label" x="60" y="70">Хроматин ремоделирован</text>
          <rect x="50" y="90" width="130" height="70" fill="#dcfce7" stroke="#4d7c0f" rx="10"></rect>
          <text class="step-note" x="65" y="120">SWI/SNF, HAT</text>
          <text class="step-note" x="65" y="140">H3K4me3, ацетил-H3</text>

          <path d="M180 125 H240" stroke="#4d7c0f" stroke-width="3" marker-end="url(#arrow1)"></path>
          <defs>
            <marker id="arrow1" viewBox="0 0 10 10" refX="10" refY="5" markerUnits="strokeWidth" markerWidth="6" markerHeight="6" orient="auto">
              <path d="M 0 0 L 10 5 L 0 10 z" fill="#4d7c0f"></path>
            </marker>
            <marker id="arrow2" viewBox="0 0 10 10" refX="10" refY="5" markerUnits="strokeWidth" markerWidth="6" markerHeight="6" orient="auto">
              <path d="M 0 0 L 10 5 L 0 10 z" fill="#1d4ed8"></path>
            </marker>
          </defs>
          <rect x="240" y="95" width="150" height="120" fill="url(#gradMediator)" stroke="#7c3aed" rx="14"></rect>
          <text class="step-label" x="260" y="120">Mediator + TFs</text>
          <text class="step-note" x="260" y="145">TFIID-TBP, TFIIA, TFIIB</text>
          <text class="step-note" x="260" y="165">Петли энхансеров</text>

          <path d="M390 155 H470" stroke="#1d4ed8" stroke-width="3" marker-end="url(#arrow2)"></path>
          <rect x="470" y="80" width="170" height="140" fill="url(#gradPolII)" stroke="#2563eb" rx="18"></rect>
          <text class="step-label" x="490" y="110">Pol II–TFIIF ядро</text>
          <text class="step-note" x="490" y="132">Присоединение TFIIE/TFIIH</text>
          <text class="step-note" x="490" y="152">CDK7 серин-5 CTD</text>

          <path d="M555 220 V270 H400" stroke="#1d4ed8" stroke-width="2.5" stroke-dasharray="6 3" marker-end="url(#arrow2)"></path>
          <rect x="300" y="250" width="200" height="90" fill="#fee2e2" stroke="#b91c1c" rx="12"></rect>
          <text class="step-label" x="320" y="280">Промоторный побег</text>
          <text class="step-note" x="320" y="300">Гибрид ДНК–РНК ~8 нт</text>
          <text class="step-note" x="320" y="320">NTP-флюкс, освобождение Mediator</text>

          <path d="M400 340 H620" stroke="#b91c1c" stroke-width="3" marker-end="url(#arrow3)"></path>
          <defs>
            <marker id="arrow3" viewBox="0 0 10 10" refX="10" refY="5" markerUnits="strokeWidth" markerWidth="6" markerHeight="6" orient="auto">
              <path d="M 0 0 L 10 5 L 0 10 z" fill="#b91c1c"></path>
            </marker>
          </defs>
          <rect x="620" y="300" width="90" height="60" fill="#fee2e2" stroke="#b91c1c" rx="10"></rect>
          <text class="step-label" x="630" y="330">Elongation</text>
          <text class="step-note" x="630" y="348">P-TEFb → Ser2</text>
        </svg>
        <div class="legend" aria-label="Условные обозначения">
          <div class="legend-item" data-type="polii"><span class="legend-swatch"></span>Полимераза II + общие факторы</div>
          <div class="legend-item" data-type="chromatin"><span class="legend-swatch"></span>Модифицированный хроматин</div>
          <div class="legend-item" data-type="rna"><span class="legend-swatch"></span>Ранний транскрипт/выход из промотора</div>
        </div>
      </section>
      <section class="block" aria-labelledby="steps-title">
        <h2 id="steps-title">Ключевые стадии и контрольные точки</h2>
        <div class="timeline" role="tablist" aria-label="Этапы">
          <button type="button" class="active" data-step="assembly" aria-selected="true" role="tab">
            <span class="title">1. Предсборка</span>
            <span class="detail">TFIID распознаёт TATA/Inr, активаторы стабилизируют Mediator.</span>
          </button>
          <button type="button" data-step="isomerization" role="tab" aria-selected="false">
            <span class="title">2. Изомеризация</span>
            <span class="detail">TFIIE рекрутирует TFIIH, открытие пузыря, загрузка шаблона.</span>
          </button>
          <button type="button" data-step="initiation" role="tab" aria-selected="false">
            <span class="title">3. Старт синтеза</span>
            <span class="detail">Abortive циклы &lt; 10 нт, CTD Ser5-P запускает кэпирование.</span>
          </button>
          <button type="button" data-step="escape" role="tab" aria-selected="false">
            <span class="title">4. Побег</span>
            <span class="detail">TFIIB/TFIIE освобождаются, NELF/DSIF контролируют удлинение.</span>
          </button>
        </div>
        <div class="step-panel" role="tabpanel" id="step-panel">
          <h3>1. Предсборка преинициаторного комплекса</h3>
          <ul>
            <li>TBP изгибает ДНК на ~80°, позиционируя +1 сайт напротив активного центра.</li>
            <li>TFIID взаимодействует с коактиваторами (TAF1/2) и метками H3K4me3.</li>
            <li>TFIIA стабилизирует TBP–ДНК, TFIIB задаёт направление транскрипции.</li>
            <li>Mediator передаёт сигналы от энхансеров, подготавливая CDK8-модуль.</li>
          </ul>
        </div>
        <div class="regulation-grid" aria-label="Регуляция">
          <div class="chip">Позитивная регуляция: ремоделлеры (SWI/SNF), H3K27ac усиливают доступность промотора.</div>
          <div class="chip">Негативная регуляция: комплексы NURD, метилирование ДНК ограничивают загрузку TFIID.</div>
          <div class="chip">Сигнальные входы: MAPK/CDK активируют фосфориляцию CTD через Mediator/CDK7.</div>
          <div class="chip">Контроль качества: TFIIS помогает Pol II преодолеть остановку на слабом стартовом сигнале.</div>
        </div>
      </section>
    </main>
    <footer>
      <div>Шкалы: время (слева направо) · структура комплекса (по высоте) · регуляторы (подписи)</div>
      <div class="controls" aria-label="Экспорт">
        <button type="button" id="export-svg">Экспорт SVG</button>
        <button type="button" id="export-png">Экспорт PNG</button>
        <button type="button" id="export-pdf">PDF / Печать</button>
        <button type="button" id="open-reference">Таблица комплексов</button>
      </div>
    </footer>
    <div class="overlay" id="reference-overlay" role="dialog" aria-modal="true" aria-labelledby="overlay-title">
      <button class="close-overlay" type="button" id="close-overlay">Закрыть</button>
      <h2 id="overlay-title">Факторный состав и функции</h2>
      <table>
        <thead>
          <tr>
            <th>Модуль</th>
            <th>Состав</th>
            <th>Функция в инициации</th>
            <th>Контроль</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>TFIID ядро</td>
            <td>TBP + TAF1/2/4/6</td>
            <td>Распознаёт TATA/Inr, контактирует с DPE/MTE</td>
            <td>Ацетил-H3/4, TAF фосфориляция</td>
          </tr>
          <tr>
            <td>TFIIB мост</td>
            <td>Rrn7-подобные домены</td>
            <td>Организация +1 канала, стабилизация ранних транскриптов</td>
            <td>Фосфориляция Ser65 уменьшает удержание</td>
          </tr>
          <tr>
            <td>TFIIE/F</td>
            <td>α/β субъединицы</td>
            <td>Рекрутирование TFIIH, поддержка открытого пузыря</td>
            <td>Убиквитинирование регулирует деградацию</td>
          </tr>
          <tr>
            <td>TFIIH</td>
            <td>XPB, XPD, CAK (CDK7/CycH/MAT1)</td>
            <td>Хеликазная активность, CTD Ser5-фосфорилирование</td>
            <td>Сигналы стресс-ответа через ATR/ATM</td>
          </tr>
          <tr>
            <td>Mediator</td>
            <td>Head/Middle/Tail + CDK8</td>
            <td>Платформа для факторов, интеграция сигналов энхансеров</td>
            <td>CDK8/CycC переключают режим паузы</td>
          </tr>
          <tr>
            <td>Pausing-модуль</td>
            <td>DSIF (Spt4/5), NELF A–E</td>
            <td>Стабилизация Pol II на +20–+60, подготовка к паузе</td>
            <td>P-TEFb фосфорилирует для освобождения</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <script>
    const timelineButtons = document.querySelectorAll('.timeline button');
    const stepPanel = document.getElementById('step-panel');
    const stepContent = {
      assembly: {
        title: '1. Предсборка преинициаторного комплекса',
        points: [
          'TBP изгибает ДНК на ~80°, позиционируя +1 сайт напротив активного центра.',
          'TFIID взаимодействует с коактиваторами (TAF1/2) и метками H3K4me3.',
          'TFIIA стабилизирует TBP–ДНК, TFIIB задаёт направление транскрипции.',
          'Mediator передаёт сигналы от энхансеров, подготавливая CDK8-модуль.'
        ]
      },
      isomerization: {
        title: '2. Изомеризация и открытие промотора',
        points: [
          'TFIIE координирует рекрутирование TFIIH и подготавливает хеликазный цикл XPB.',
          'ATP-зависимое расплетание формирует открытый пузырь (-9/+2) вокруг TSS.',
          'Шаблонная цепь позиционируется в канал Pol II при участии TFIIB-B reader.',
          'CTD Ser5-фосфориляция инициирует рекрутирование комплекса кэпирования.'
        ]
      },
      initiation: {
        title: '3. Старт синтеза и ранние транскрипты',
        points: [
          'Pol II инициирует синтез с +1 аденина/цитозина, формируя короткие РНК.',
          'Abortive циклы (&lt;10 нт) очищают канал; σ-подобная петля TFIIB ориентирует выход.',
          'NELF/DSIF начинают связываться, подготавливая платформу паузы.',
          'Ser5-P CTD рекрутирует TFIIH CAK и фактор кэпирования CE/HCE.'
        ]
      },
      escape: {
        title: '4. Промоторный побег и фиксация паузы',
        points: [
          'Pol II проходит +10/+12, выбрасывая TFIIB/TFIIE и ослабляя связи Mediator.',
          'TFIIH остаётся до формирования устойчивого гибрида ДНК–РНК (~8–9 нт).',
          'DSIF стабилизирует удлинение, NELF удерживает полимеразу на +20/+60.',
          'P-TEFb (CDK9/CycT) фосфорилирует NELF/DSIF и CTD Ser2, переводя в элонгацию.'
        ]
      }
    };

    timelineButtons.forEach(button => {
      button.addEventListener('click', () => {
        timelineButtons.forEach(b => {
          b.classList.toggle('active', b === button);
          b.setAttribute('aria-selected', b === button);
        });
        const data = stepContent[button.dataset.step];
        if (!data) return;
        const listItems = data.points.map(point => `<li>${point}</li>`).join('');
        stepPanel.innerHTML = `<h3>${data.title}</h3><ul>${listItems}</ul>`;
      });
    });

    function download(filename, content, type) {
      const blob = new Blob([content], { type });
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = filename;
      link.click();
      URL.revokeObjectURL(link.href);
    }

    document.getElementById('export-svg').addEventListener('click', () => {
      const svg = document.querySelector('.flow-map svg');
      const serializer = new XMLSerializer();
      const source = serializer.serializeToString(svg);
      const svgWithHeader = `<?xml version="1.0" encoding="UTF-8"?>\n${source}`;
      download('transcription_initiation_polII.svg', svgWithHeader, 'image/svg+xml;charset=utf-8');
    });

    document.getElementById('export-png').addEventListener('click', () => {
      const svg = document.querySelector('.flow-map svg');
      const serializer = new XMLSerializer();
      const svgData = serializer.serializeToString(svg);
      const svgBlob = new Blob([svgData], { type: 'image/svg+xml;charset=utf-8' });
      const url = URL.createObjectURL(svgBlob);
      const img = new Image();
      const canvas = document.createElement('canvas');
      const scale = window.devicePixelRatio || 2;
      const bbox = svg.viewBox.baseVal;
      canvas.width = bbox.width * scale;
      canvas.height = bbox.height * scale;
      const ctx = canvas.getContext('2d');
      img.onload = () => {
        ctx.setTransform(scale, 0, 0, scale, 0, 0);
        ctx.fillStyle = '#ffffff';
        ctx.fillRect(0, 0, bbox.width, bbox.height);
        ctx.drawImage(img, 0, 0);
        URL.revokeObjectURL(url);
        canvas.toBlob(blob => {
          download('transcription_initiation_polII.png', blob, 'image/png');
        }, 'image/png');
      };
      img.src = url;
    });

    document.getElementById('export-pdf').addEventListener('click', () => {
      window.print();
    });

    const overlay = document.getElementById('reference-overlay');
    document.getElementById('open-reference').addEventListener('click', () => {
      overlay.classList.add('active');
    });
    document.getElementById('close-overlay').addEventListener('click', () => {
      overlay.classList.remove('active');
    });
    overlay.addEventListener('click', event => {
      if (event.target === overlay) {
        overlay.classList.remove('active');
      }
    });
  </script>
</body>
</html>
